# check interfaces
hciconfig -a

# make sure BT is enabled
rfkill list
rfkill unblock all
rfkill list

#
# managing multiple controllers
#
# show all availabel controllers
list
# change controller (<tab> to show options)
select F0:2F:74:6B:13:F7
# info about currently selected controller
show
# name current controller
system-alias my_ctrl
# set current one as default


# scanning / pairing
discoverable on
pairing on

# show info about current device
info
# list devices
devices
devices Paired
devices Trusted
devices Connected

$apt install bluez
$ bluetoothctl
power on
agent on
default-agent
scan on
pair XX:XX:XX:XX:XX:XX
trust XX:XX:XX:XX:XX:XX
connect XX:XX:XX:XX:XX:XX
# name it
set-alias my_dev


# to make pulseaudio work
apt install pulseaudio-module-bluetooth
apt install bluez-firmware

#
# serial port over BTLE == SPP profile
#

# find device:
hcitool scan

# connect to a device:
rfcomm connect /dev/rfcomm0 01:23:45:67:89:AB

# I/O with it
picocom -b 9600 /dev/rfcomm0

# to persist, edit:
# /etc/bluetooth/rfcomm.conf
rfcomm0 {
  # auto-bind at startup?
  bind no;
  device 01:23:45:67:89:AB;
  channel 3;
  comment "my serial port";
}

# check power level of the headeset
upower --dump


#
# BTLE GATT profile
#

$ bluetoothctl
connect 28:CD:C1:05:BD:53
menu gatt
list-attributes # look for 'Characteristic (Handle 0x....)' entries for readable / writable stuff
select-attribute /org/bluez/hci0/dev_28_CD_C1_05_BD_53/service000b/char000c # from 'Characteristic' part
read
notify on
notify off
